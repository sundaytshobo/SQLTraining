--1:CREATING A BEST_BUY CUSTOMERS  TABLE
CREATE TABLE BEST_BUY_CUSTOMERS
( 
 CUSTOMER_ID INT NOT NULL,
 FIRST_NAME VARCHAR(50) NULL,
 LAST_NAME VARCHAR(50) NULL,
 AGE INT NOT NULL,
COUNTRY VARCHAR(50) NULL
);


--2:LOAD DATA TO THE BEST_BUY_CUSTOMERS TABLE
INSERT INTO BEST_BUY_CUSTOMERS
(CUSTOMER_ID, FIRST_NAME, LAST_NAME, AGE, COUNTRY)
VALUES (1, 'JOHN', 'DOE', 31, 'USA'),
(2, 'ROBERT', 'LUNA', 22, 'USA'),
(3, 'DAVID', 'ROBINSON', 22, 'UK'),
(4, 'JOHN', 'REINHARDT', 25, 'UK'),
(5, 'BETTY', 'DOE', 28, 'UAE')

 
--2:CREATING AN ORDER TABLE

CREATE TABLE BEST_BUY_ORDERS
(
   ORDER_ID INT NOT NULL,
   ITEM VARCHAR(50) NULL,
   AMOUNT MONEY,
   CUSTOMER_ID INT NOT NULL
);


--2:LOAD DATA TO THE ( 1, 'KEYBOARD', 400,4), TABLE
INSERT INTO BEST_BUY_ORDERS
(ORDER_ID, ITEM, AMOUNT, CUSTOMER_ID)
VALUES ( 1, 'KEYBOARD', 400,4),
( 2, 'MOUSE', 300,4),
( 3, 'MONITOR', 12000,3),
( 4, 'KEYBOARD', 400,1),
( 5, 'MOUSEPAD', 250,2);
--2:CREATING A BEST_BUY_PRODUCTS TABLE

CREATE TABLE BEST_BUY_PRODUCTS
(
   PRODUCT_ID INT NOT NULL,
   PRODUCT_NUMBER VARCHAR(50) NULL,
   AMOUNT MONEY,
   CUSTOMER_ID INT NOT NULL
);


--2:LOAD DATA TO THE ( 1, 'KEYBOARD', 400,4), TABLE
INSERT INTO BEST_BUY_PRODUCTS
(PRODUCT_ID, PRODUCT_NUMBER, AMOUNT, CUSTOMER_ID)
VALUES ( 1, 'KEYBOARD', 400,5),
( 2, 'HEADPHONE', 300,4),
( 3, 'LAPTOP', 12000,3),
( 4, 'PEN', 400,1),
( 5, 'MOUSEPAD', 250,2);

--CHECK RECORDS IN NEWLY CREATED TABLES
SELECT *
FROM BEST_BUY_CUSTOMERS

SELECT *
FROM BEST_BUY_PRODUCTS

SELECT *
FROM BEST_BUY_ORDERS

--JOINS are used to pull data from more than 1 table
Select* 
From BEST_BUY_CUSTOMERS as a 
Join BEST_BUY_PRODUCTS as b
on A.CUSTOMER_ID = B.CUSTOMER_ID 
Join BEST_BUY_ORDERS as c
on A.CUSTOMER_ID = C.CUSTOMER_ID 

--Inner Join brings only matching records
Select* 
From BEST_BUY_CUSTOMERS as a 
Inner Join BEST_BUY_PRODUCTS as b
on A.CUSTOMER_ID = B.CUSTOMER_ID 
Inner Join BEST_BUY_ORDERS as c
on A.CUSTOMER_ID = C.CUSTOMER_ID 

--QUESTION 1: WRITE A QUERY THAT SHOWS CUSTOMER WHO BOUGHT ITEM MOUSE

--Inner Join brings only matching records
Select* 
From BEST_BUY_CUSTOMERS as a 
Inner Join BEST_BUY_PRODUCTS as b
on A.CUSTOMER_ID = B.CUSTOMER_ID 
Inner Join BEST_BUY_ORDERS as c
on A.CUSTOMER_ID = C.CUSTOMER_ID 
Where C.ITEM = 'Mouse'

--How to change a column 
Exec sp_rename 'BEST_BUY_PRODUCTS.Product_Number',
'Product_Name','column';

--How to add a new column to an existing table


--SHOW ME THE CUSTOMER INFO AND THE ITEM THAT THEY ORDER, THE PRODUCT BUT ONLY SHOW THE PRODUCT FOR PEN

--Inner Join brings only matching records
Select* 
From BEST_BUY_CUSTOMERS as a 
Inner Join BEST_BUY_PRODUCTS as b
on A.CUSTOMER_ID = B.CUSTOMER_ID 
Inner Join BEST_BUY_ORDERS as c
on A.CUSTOMER_ID = C.CUSTOMER_ID 
Where B.Product_Name = 'Pen'